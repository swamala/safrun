# ===========================================
# SAFRUN Backend Environment Variables
# Complete Configuration for Production
# ===========================================

# ===========================================
# Application Settings
# ===========================================
NODE_ENV=development
PORT=3001
API_PREFIX=api/v1
BASE_URL=http://localhost:3001

# ===========================================
# Database (PostgreSQL)
# ===========================================
DATABASE_URL="postgresql://postgres:password@localhost:5432/safrun?schema=public"
# For production, use connection pooling:
# DATABASE_URL="postgresql://user:pass@host:5432/safrun?schema=public&connection_limit=10"

# ===========================================
# Redis Configuration
# ===========================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
# For production:
# REDIS_URL=redis://user:pass@host:6379/0

# ===========================================
# JWT Authentication
# ===========================================
JWT_SECRET=your-super-secret-jwt-key-change-in-production-min-32-chars
JWT_EXPIRES_IN=15m
JWT_REFRESH_SECRET=your-super-secret-refresh-key-change-in-production
JWT_REFRESH_EXPIRES_IN=7d

# ===========================================
# Encryption (AES-256)
# ===========================================
# Must be exactly 32 characters
ENCRYPTION_KEY=your-32-character-encryption-key

# ===========================================
# Rate Limiting
# ===========================================
THROTTLE_TTL=60
THROTTLE_LIMIT=100
# Location updates: max per second
LOCATION_RATE_LIMIT=5
# SOS triggers: max per hour
SOS_RATE_LIMIT=3

# ===========================================
# Cloudflare Turnstile (Anti-abuse)
# ===========================================
TURNSTILE_SECRET_KEY=your-turnstile-secret-key
TURNSTILE_ENABLED=true

# ===========================================
# Twilio (SMS Notifications)
# ===========================================
TWILIO_ACCOUNT_SID=your-twilio-account-sid
TWILIO_AUTH_TOKEN=your-twilio-auth-token
TWILIO_PHONE_NUMBER=+1234567890

# ===========================================
# Push Notifications (Expo)
# ===========================================
EXPO_ACCESS_TOKEN=your-expo-access-token
# Optional: For APNs direct push (iOS)
APNS_KEY_ID=
APNS_TEAM_ID=
APNS_KEY_PATH=

# ===========================================
# File Upload (Avatars)
# ===========================================
UPLOAD_DIR=./uploads
MAX_FILE_SIZE_MB=10
# For S3-compatible storage:
# S3_BUCKET=safrun-uploads
# S3_REGION=us-east-1
# S3_ACCESS_KEY=
# S3_SECRET_KEY=
# S3_ENDPOINT=

# ===========================================
# WebSocket Configuration
# ===========================================
WS_PORT=3002
WS_CORS_ORIGIN=http://localhost:3000

# ===========================================
# Geo & Location Settings
# ===========================================
DEFAULT_NEARBY_RADIUS_METERS=1000
SOS_BROADCAST_RADIUS_METERS=1000
MAX_RESPONDERS_PER_SOS=10
CLUSTER_RADIUS_METERS=20
# Maximum acceptable GPS accuracy in meters
MAX_LOCATION_ACCURACY_METERS=100
# Runner location TTL in Redis (seconds)
LOCATION_TTL_SECONDS=30

# ===========================================
# SOS Settings
# ===========================================
SOS_VERIFICATION_TIMEOUT_SECONDS=5
SOS_ESCALATION_LEVEL1_SECONDS=30
SOS_ESCALATION_LEVEL2_SECONDS=60
SOS_AUTO_CANCEL_SECONDS=10

# ===========================================
# Location Tracking
# ===========================================
LOCATION_UPDATE_INTERVAL_MS=3000
LOCATION_HISTORY_RETENTION_HOURS=24
HEARTBEAT_INTERVAL_SECONDS=20

# ===========================================
# Session Settings
# ===========================================
MAX_SESSION_PARTICIPANTS=50
SESSION_IDLE_TIMEOUT_MINUTES=30

# ===========================================
# CORS Configuration
# ===========================================
CORS_ORIGINS=http://localhost:3000,http://localhost:8081,exp://192.168.1.1:8081

# ===========================================
# Logging
# ===========================================
LOG_LEVEL=debug
# For production:
# LOG_LEVEL=info
LOG_FORMAT=pretty
# For production:
# LOG_FORMAT=json

# ===========================================
# Monitoring (Optional)
# ===========================================
# SENTRY_DSN=https://your-sentry-dsn
# DATADOG_API_KEY=
# NEW_RELIC_LICENSE_KEY=

# ===========================================
# Feature Flags
# ===========================================
FEATURE_SOS_SMS_FALLBACK=true
FEATURE_LOCATION_SMOOTHING=true
FEATURE_AUTO_ESCALATION=true
FEATURE_MILESTONES=true
